<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMU Example - Z Axis</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f4f4f4;
        }
        #output {
            font-size: 24px;
        }
    </style>
</head>
<body>
    <div id="output">Z-axis Rotation: 0°</div>

    <script>
        let rotationZ = 0; // שיעור סיבוב ציר Z
        let lastTimestamp = 0; // זמן הקריאה האחרון

        // פונקציה לבדוק אם המכשיר מונח שטוח
        const isFlat = ({ x, y, z }) => {
            return Math.abs(z) > Math.abs(x) && Math.abs(z) > Math.abs(y);
        };

        // התחלת המעקב אחרי הנתונים של ה-IMU
        window.addEventListener("devicemotion", (event) => {
            const acceleration = event.accelerationIncludingGravity;
            const rotationRate = event.rotationRate || { alpha: 0 };

            // אם המכשיר שטוח, אנו יכולים לעדכן את הכיוון
            if (isFlat(acceleration)) {
                // חישוב השינוי בכיוון
                if (lastTimestamp) {
                    const deltaTime = (event.timeStamp - lastTimestamp) / 1000; // הזמן שעבר בשניות
                    rotationZ += rotationRate.alpha * deltaTime; // עדכון הסיבוב סביב ציר Z
                    rotationZ = rotationZ % 360; // נשמור על סיבוב ב-0°-360°
                }

                // עדכון התצוגה
                document.getElementById("output").innerText = `Z-axis Rotation: ${rotationZ.toFixed(2)}°`;
            }

            lastTimestamp = event.timeStamp;
        });
    </script>
</body>
</html>
